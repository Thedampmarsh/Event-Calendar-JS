<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <main class="outterContainer">
    <div class="event-form">
      <h2>Add Event</h2>
      <input type="text" id="eventTitle" placeholder="Event Title">
      <select id="eventColor">
        <option value="red">Red</option>
        <option value="white">White</option>
        <option value="blue">Blue</option>
        <option value="blue">Gold</option>
      </select>
      <select id="eventMonths">
        <option value="0">January</option>
        <option value="1">February</option>
        <option value="2">March</option>
        <option value="3">April</option>
        <option value="4">May</option>
        <option value="5">June</option>
        <option value="6">July</option>
        <option value="7">August</option>
        <option value="8">September</option>
        <option value="9">October</option>
        <option value="10">November</option>
        <option value="11">December</option>
      </select>
      <select id="eventDay">
        <!-- Options will be generated dynamically using JavaScript -->
      </select>
      <!-- <label for="startTime">Start Time:</label>
        <input type="time" id="startTime" name="startTime">
        <label for="endTime">End Time:</label>
        <input type="time" id="endTime" name="endTime"> -->
      <select id="eventYears">
        <option value="2024">2024</option>
        <option value="2025">2025</option>
        <option value="2026">2026</option>
        <option value="2027">2027</option>
        <option value="2028">2028</option>
        <option value="2029">2029</option>
        <option value="2030">2030</option>
      </select>
      <button id="addEventButton">Add Event</button>
    </div>
    <!-- Date Info -->
    <div class="dateContainer">
      <h2 class="dateInfo" id="dateInfo">
        <!-- <span>May 10, 2024</span> -->
      </h2>
      <select id="eventMonth">
        <option value="0">January</option>
        <option value="1">February</option>
        <option value="2">March</option>
        <option value="3">April</option>
        <option value="4">May</option>
        <option value="5">June</option>
        <option value="6">July</option>
        <option value="7">August</option>
        <option value="8">September</option>
        <option value="9">October</option>
        <option value="10">November</option>
        <option value="11">December</option>
      </select>
      <select id="eventYear">
        <option value="2024">2024</option>
        <option value="2025">2025</option>
        <option value="2026">2026</option>
        <option value="2027">2027</option>
        <option value="2028">2028</option>
        <option value="2029">2029</option>
        <option value="2030">2030</option>
      </select>
      <div class="monthButtons">
        <button class="prevMonth">
          < </button>
            <button class="nextMonth">></button>
      </div>
    </div>
    <!-- Start of calendar -->
    <ol class="calendar">
      <li class="calendar-day calendar-day--begin-week calendar-day--past calendar-day--not-month" data-weekday="Mon"
        data-week="39">
        <!-- <span class="calendar-day__number">26</span> -->
        <!-- <div class="calendar-day__content"></div> -->
      </li>
      <li class="calendar-day calendar-day--past calendar-day--not-month" data-weekday="Tue" data-week="39">
        <!-- <span class="calendar-day__number">27</span> -->

      </li>
      <li class="calendar-day calendar-day--past calendar-day--not-month" data-weekday="Wed" data-week="39">
        <!-- <span class="calendar-day__number">28</span> -->

      </li>
      <li class="calendar-day calendar-day--past calendar-day--entry calendar-day--not-month" data-weekday="Thu"
        data-week="39">
        <!-- <span class="calendar-day__number">29</span> -->

      </li>
      <li class="calendar-day calendar-day--past calendar-day--not-month" data-weekday="Fri" data-week="39">
        <!-- <span class="calendar-day__number">30</span> -->

      </li>
      <li class="calendar-day calendar-day--past calendar-day--entry" data-weekday="Sat" data-week="39">
        <!-- <span class="calendar-day__number">01</span> -->

      </li>
      <li class="calendar-day calendar-day--past calendar-day--entry" data-weekday="Sun" data-week="39">


      </li>
      <li class="calendar-day calendar-day--begin-week calendar-day--past" data-weekday="Mon" data-week="40">


      </li>
      <li class="calendar-day calendar-day--past" data-weekday="Tue" data-week="40">


      </li>
      <li class="calendar-day calendar-day--past" data-weekday="Wed" data-week="40">


      </li>
      <li class="calendar-day calendar-day--past" data-weekday="Thu" data-week="40">


      </li>
      <li class="calendar-day calendar-day--today" data-weekday="Fri" data-week="40">


      </li>
      <li class="calendar-day" data-weekday="Sat" data-week="40">


      </li>
      <li class="calendar-day calendar-day--entry" data-weekday="Sun" data-week="40">


      </li>
      <li class="calendar-day calendar-day--begin-week calendar-day--entry" data-weekday="Mon" data-week="41">


      </li>
      <li class="calendar-day calendar-day--entry" data-weekday="Tue" data-week="41">


      </li>
      <li class="calendar-day calendar-day--entry" data-weekday="Wed" data-week="41">


      </li>
      <li class="calendar-day" data-weekday="Thu" data-week="41">


      </li>
      <li class="calendar-day" data-weekday="Fri" data-week="41">


      </li>
      <li class="calendar-day" data-weekday="Sat" data-week="41">


      </li>
      <li class="calendar-day" data-weekday="Sun" data-week="41">


      </li>
      <li class="calendar-day calendar-day--begin-week" data-weekday="Mon" data-week="42">


      </li>
      <li class="calendar-day" data-weekday="Tue" data-week="42">


      </li>
      <li class="calendar-day" data-weekday="Wed" data-week="42">


      </li>
      <li class="calendar-day" data-weekday="Thu" data-week="42">


      </li>
      <li class="calendar-day" data-weekday="Fri" data-week="42">


      </li>
      <li class="calendar-day" data-weekday="Sat" data-week="42">


      </li>
      <li class="calendar-day" data-weekday="Sun" data-week="42">


      </li>
      <li class="calendar-day calendar-day--begin-week" data-weekday="Mon" data-week="43">
      </li>
      <li class="calendar-day" data-weekday="Tue" data-week="43">
      </li>
      <li class="calendar-day" data-weekday="Wed" data-week="43">
      </li>
      <li class="calendar-day" data-weekday="Thu" data-week="43">
      </li>
      <li class="calendar-day" data-weekday="Fri" data-week="43">
      </li>
      <li class="calendar-day" data-weekday="Sat" data-week="43">
      </li>
      <li class="calendar-day" data-weekday="Sun" data-week="43">
      </li>
      <li class="calendar-day calendar-day--begin-week" data-weekday="Mon" data-week="44">

      </li>
      <li class="calendar-day calendar-day--not-month" data-weekday="Tue" data-week="44">
      </li>
      <li class="calendar-day calendar-day--not-month" data-weekday="Wed" data-week="44">
      </li>
      <li class="calendar-day calendar-day--not-month" data-weekday="Thu" data-week="44">
      </li>
      <li class="calendar-day calendar-day--not-month" data-weekday="Fri" data-week="44">
      </li>
      <li class="calendar-day calendar-day--not-month" data-weekday="Sat" data-week="44">
      </li>
      <li class="calendar-day calendar-day--not-month" data-weekday="Sun" data-week="44">
      </li>
    </ol>
  </main>
  <!-- <script src="app.js"></script> -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {

    // Get current year
    const currentDate = new Date();
    const currentYear = currentDate.getFullYear();

      fetch(`events_${currentYear}.json`)
        .then(response => response.json())
        .then(data => {
          const events = data.events;
          const eventMonth = document.getElementById('eventMonth');
          const eventDay = document.getElementById('eventDay');
          const eventYear = document.getElementById('eventYear');

          const prevButton = document.querySelector('.prevMonth');
          const nextButton = document.querySelector('.nextMonth');

          const currentDate = new Date();
          const currentMonth = currentDate.getMonth();
          const currentYear = currentDate.getFullYear();
          const currentDay = currentDate.getDate();
          const daysOfWeek = ["Sun", "Mon", "Tue", "Wed", "Thur", "Fri", "Sat"];

          function updateDateInfo() {
            const dateInfo = document.getElementById('dateInfo');
            const fullDate = `${eventMonth.options[eventMonth.selectedIndex].text} ${currentDay}, ${currentYear}`;
            dateInfo.textContent = fullDate;
          }

          function updateDays() {

            const year = eventYear.value;
            const month = eventMonth.value;
            const monthName = eventMonth.options[eventMonth.selectedIndex].text;

            fetch(`events_${year}.json`)
          .then(response => response.json())
          .then(data => {

            // const days = events[year][monthName] || {};
            const eventData = data.events[year][monthName] || {};

            eventDay.innerHTML = '';

            Object.keys(eventData).forEach(day => {
              const option = document.createElement('option');
              option.value = day;
              option.textContent = day;
              eventDay.appendChild(option);
            });

            updateCalendar(monthName, eventData);
          })
        .catch(error => console.error('Error fetching events:', error));
          }

// Define a function to calculate the day of the week using Zeller's Congruence formula
// h = (q + (13 * (m + 1) / 5) + K + (K / 4) + (J / 4) - (2 * J)) % 7
function calculateDayOfWeek(year, month, day) {
  // Adjust the month for January and February as per Zeller's Congruence
  if (month < 3) {
    month += 12;
    year -= 1;
  }

  const q = day; // Day of the month
  const m = month + 1; // Adjusted month
  const K = year % 100; // Year of the century
  const J = Math.floor(year / 100); // Zero-based century

  // Calculate the day of the week using Zeller's Congruence formula
  const h = (q + Math.floor((13 * (m + 1)) / 5) + K + Math.floor(K / 4) + Math.floor(J / 4) - (2 * J)) % 7;

  // Convert the result to match the indexing of your daysOfWeek array
  return (h + 5) % 7; // (0 = Saturday, 1 = Sunday, ..., 6 = Friday)
}



function updateCalendar(monthName, days) {
    const calendar = document.querySelector('.calendar');
    calendar.innerHTML = '';

    const year = eventYear.value;
    const month = eventMonth.value;

    const firstDayOfMonth = new Date(year, month, 1);
    const lastDayOfMonth = new Date(year, month + 1, 0).getDate();
    const daysOfWeek = ["Sun", "Mon", "Tue", "Wed", "Thur", "Fri", "Sat"];

    for (let day = 1; day <= Object.keys(days).length; day++) {
        const li = document.createElement('li');
        li.className = 'calendar-day';
        const span = document.createElement('span');
        span.className = 'calendar-day__number';
        span.textContent = day;

        // const dayOfWeekIndex = (firstDayOfMonth.getDay() + day - 1) % 7; // Calculate the day of the week for the current day
        
        const date = new Date(year, month, day);
        const dayOfWeekIndex = date.getDay();

        const dayOfWeek = daysOfWeek[dayOfWeekIndex];

        li.dataset.weekday = dayOfWeek;
        li.appendChild(span);


        const div = document.createElement('div');
        div.className = 'calendar-day__content';

        if (days[day]) {
            days[day].forEach(event => {
                const eventDiv = document.createElement('div');
                eventDiv.textContent = event;
                div.appendChild(eventDiv);
            });
        }

        li.appendChild(div);
        calendar.appendChild(li);
    }
}

          eventMonth.addEventListener('change', updateDays);
          eventYear.addEventListener('change', updateDays);
          prevButton.addEventListener('click', () => {
            if (eventMonth.selectedIndex > 0) {
              eventMonth.selectedIndex--;
            } else if (eventYear.selectedIndex > 0) {
              eventYear.selectedIndex--;
              eventMonth.selectedIndex = 11;
            }
            updateDays();
          });
          nextButton.addEventListener('click', () => {
            if (eventMonth.selectedIndex < 11) {
              eventMonth.selectedIndex++;
            } else if (eventYear.selectedIndex < eventYear.options.length - 1) {
              eventYear.selectedIndex++;
              eventMonth.selectedIndex = 0;
            }
            updateDays();
          });

          // eventMonth.value = currentMonth;
          // eventYear.value = currentYear;
          // dateInfo.textContent = currentMonth
          
          eventMonth.selectedIndex = currentMonth;
          updateDateInfo();
          updateDays();
        })
        .catch(error => console.error('Error fetching events:', error));
    });
  </script>
</body>

</html>